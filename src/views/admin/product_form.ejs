<%- include('../partials/header', { title, admin, flash }) %>

<% const isEdit = !!product; %>

<h1 class="h5 mb-3 admin-title"><%= isEdit ? '编辑商品' : '新增商品' %></h1>

<div class="card admin-card">
  <div class="card-body">
    <form class="admin-form" method="post" action="<%= isEdit ? ('/admin/products/' + product.id + '/edit') : '/admin/products/new' %>">
      <div class="mb-3">
        <label class="form-label">商品名称</label>
        <input class="form-control" name="name" required maxlength="200" value="<%= isEdit ? product.name : '' %>">
      </div>

      <div class="mb-3">
        <label class="form-label">商品描述</label>
        <textarea class="form-control" name="description" rows="4" maxlength="2000"><%= isEdit ? (product.description || '') : '' %></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label">价格（元）</label>
        <input class="form-control" name="price_yuan" type="number" step="0.01" min="0" required value="<%= isEdit ? (product.price_cents/100).toFixed(2) : '0.00' %>">
      </div>

      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="is_active" name="is_active" <%= (isEdit ? product.is_active : true) ? 'checked' : '' %>>
        <label class="form-check-label" for="is_active">上架</label>
      </div>

      <div class="d-flex gap-2 admin-actions">
        <button class="btn btn-primary" type="submit">保存</button>
        <a class="btn btn-outline-secondary" href="/admin/products">返回</a>
      </div>
    </form>
  </div>
</div>

<%- include('../partials/footer') %>
